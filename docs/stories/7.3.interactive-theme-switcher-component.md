# Story 7.3: Interactive Theme Switcher Component

## Status
Approved

## Story
**As a** Developer,
**I want** an intuitive floating theme switcher interface,
**so that** I can easily test and compare all three themes in real-time during development.

## Acceptance Criteria
1. A floating theme switcher component is created with fixed positioning for persistent access.
2. Theme switcher displays visual color previews for Ocean, Sunset, and Forest themes.
3. Real-time theme switching is implemented without requiring page reloads or navigation.
4. Light/dark mode toggle controls are integrated within the theme switcher interface.
5. Theme switcher is fully responsive and accessible across desktop, tablet, and mobile devices.
6. Component provides clear visual feedback for currently selected theme and mode.
7. Theme switcher positioning does not interfere with existing page content or navigation.
8. Keyboard navigation and screen reader support are implemented for accessibility.

## Tasks / Subtasks
- [ ] Create floating theme switcher component (AC: 1, 7)
  - [ ] Design component with fixed positioning (bottom-right corner)
  - [ ] Implement collapsible/expandable interface to minimize space usage
  - [ ] Ensure positioning doesn't interfere with existing navigation or CTAs
  - [ ] Add proper z-index management for layering
- [ ] Implement theme preview interface (AC: 2, 6)
  - [ ] Create visual color swatches for Ocean, Sunset, and Forest themes
  - [ ] Display theme names and primary color indicators
  - [ ] Implement active theme highlighting and selection feedback
  - [ ] Show preview of key colors (primary, accent, background) for each theme
- [ ] Add real-time theme switching functionality (AC: 3)
  - [ ] Integrate with useTheme hook from Story 7.1
  - [ ] Implement immediate theme application on selection
  - [ ] Ensure smooth transitions using dynamic loading from Story 7.2
  - [ ] Add click/tap handlers for theme selection
- [ ] Integrate light/dark mode controls (AC: 4)
  - [ ] Add toggle switch for light/dark mode within switcher
  - [ ] Show current mode state with clear visual indicators
  - [ ] Implement mode switching functionality
  - [ ] Ensure mode preference persists with theme selection
- [ ] Implement responsive design (AC: 5)
  - [ ] Design mobile-optimized version with touch-friendly targets
  - [ ] Implement tablet layout with appropriate sizing
  - [ ] Ensure desktop version provides optimal development experience
  - [ ] Test across all breakpoints for usability
- [ ] Add comprehensive accessibility support (AC: 8)
  - [ ] Implement keyboard navigation (Tab, Enter, Arrow keys)
  - [ ] Add ARIA labels and descriptions for screen readers
  - [ ] Ensure proper focus management and indicators
  - [ ] Implement skip links for theme switcher access
- [ ] Add unit and integration tests (Testing Requirements)
  - [ ] Test theme switching functionality and state updates
  - [ ] Test light/dark mode toggle behavior
  - [ ] Test keyboard navigation and accessibility features
  - [ ] Test responsive behavior across device sizes
  - [ ] Test component positioning and visual feedback

## Dev Notes

### Previous Story Dependencies
[Source: docs/stories/7.1.theme-context-state-management.md, 7.2.dynamic-theme-loading-system.md]
**Required from Story 7.1:**
- useTheme hook for accessing theme state and switching functions
- ThemeContext providing current theme and mode information
- Type-safe theme options ('ocean', 'sunset', 'forest') and modes ('light', 'dark')

**Required from Story 7.2:**
- Dynamic theme loading system with smooth transitions
- CSS class management for theme application
- Performance-optimized theme switching without layout shifts

### Tech Stack Requirements
[Source: docs/architecture/3-tech-stack.md]
**MUST use these exact versions:**
- **Framework**: Next.js ~14.2.3 (App Router with static export)
- **UI Library**: React ~18.3.1 (Component architecture with hooks)
- **Styling**: Tailwind CSS ~3.4.3 (Utility-first CSS with design system)
- **Language**: TypeScript ~5.4.5 (Type safety throughout)
- **Testing**: Jest / RTL ~29.7.0 (Unit and integration testing)

### Project Structure Requirements
[Source: docs/architecture/5-unified-project-structure.md]
**File locations for this story:**
- `/src/components/ui/ThemeSwitcher.tsx` - Main theme switcher component
- `/src/components/ui/ThemePreview.tsx` - Individual theme preview component
- `/src/components/ui/ModeToggle.tsx` - Light/dark mode toggle component
- `/src/components/ui/ThemeSwitcher.test.tsx` - Unit tests for theme switcher
- `/src/styles/theme-switcher.css` - Theme switcher specific styling (if needed)

**Architecture compliance:**
- Follow existing UI component patterns in `/src/components/ui/`
- Use TypeScript interfaces for component props and state
- Maintain shadcn/ui component library styling consistency
- Ensure static export compatibility for Vercel deployment

### Theme Configuration Integration
[Source: src/styles/themes/index.ts]
**Theme Data Structure:**
```typescript
const AVAILABLE_THEMES = [
  {
    name: 'Ocean',
    id: 'ocean',
    description: 'Deep blue ocean tones with excellent contrast',
    colors: {
      primary: 'hsl(200 100% 25%)',
      accent: 'hsl(180 100% 35%)',
      background: 'hsl(200 30% 98%)',
    }
  },
  // Sunset and Forest themes...
];
```

**Component Integration:**
- Import AVAILABLE_THEMES for theme preview generation
- Use theme metadata for visual previews and descriptions
- Integrate with existing theme color definitions
- Display theme colors using actual HSL values from configuration

### UI Design Requirements
**Visual Design:**
- Floating position: fixed bottom-right with appropriate margins (16-24px)
- Collapsible design: Compact when closed, expanded when active
- Color previews: Small circular swatches showing primary theme colors
- Mode toggle: Clear light/dark indicator with switch/toggle design
- Active state: Clear highlighting of currently selected theme and mode

**Interactive Design:**
- Hover states: Subtle elevation and color changes for better UX
- Click feedback: Immediate visual response on selection
- Transition animations: Smooth expand/collapse and selection feedback
- Loading states: Brief indication during theme switching (if needed)

### Responsive Design Strategy
**Mobile (320px - 767px):**
- Touch-friendly targets (minimum 44px)
- Simplified layout with stacked theme previews
- Swipe-friendly interaction patterns
- Optimized positioning for mobile navigation

**Tablet (768px - 1023px):**
- Balanced layout with adequate spacing
- Touch and mouse interaction support
- Appropriate sizing for both orientations
- Consistent with desktop patterns but touch-optimized

**Desktop (1024px+):**
- Full feature set with hover states
- Keyboard navigation fully supported
- Developer-focused information display
- Optimal positioning for development workflow

### Accessibility Implementation
**Keyboard Navigation:**
- Tab order: Logical flow through theme options and mode toggle
- Arrow keys: Navigate between theme options
- Enter/Space: Select theme or toggle mode
- Escape: Close expanded switcher (if applicable)

**Screen Reader Support:**
- ARIA roles: Proper radiogroup for themes, switch for mode toggle
- ARIA labels: Descriptive labels for each theme and current selection
- ARIA descriptions: Additional context for theme characteristics
- Live regions: Announce theme changes to screen readers

**Visual Accessibility:**
- Focus indicators: Clear keyboard focus outlines
- Color contrast: Meet WCAG AA standards for all text and controls
- Motion: Respect prefers-reduced-motion for animations
- Size targets: Minimum 44px touch targets for mobile

### Component Architecture
**ThemeSwitcher Component:**
- Main container with state management
- Integration with useTheme hook
- Responsive layout handling
- Accessibility coordination

**ThemePreview Component:**
- Individual theme representation
- Color swatch display
- Selection state management
- Accessibility attributes

**ModeToggle Component:**
- Light/dark mode switching
- Visual state representation
- Integration with theme context
- Accessible toggle implementation

### Performance Considerations
**Rendering Optimization:**
- Use React.memo for theme preview components
- Minimize re-renders during theme switching
- Efficient event handling for selections
- Lazy load theme data if needed

**CSS Optimization:**
- Use CSS-in-JS sparingly, prefer Tailwind classes
- Minimize custom CSS for better maintainability
- Optimize transition performance
- Consider CSS containment for isolated styling

### Testing
[Source: docs/architecture/8-testing-strategy.md]
**Testing Standards:**
- **Unit Tests**: Component behavior, state management, accessibility
- **Integration Tests**: Theme switching workflow, context integration
- **Accessibility Tests**: Keyboard navigation, screen reader support

**Required Test Cases:**
- Theme selection triggers correct theme switching
- Light/dark mode toggle updates context state
- Keyboard navigation works correctly across all elements
- Component renders correctly across responsive breakpoints
- ARIA attributes are correctly applied for accessibility
- Visual feedback provides clear indication of current selections
- Component positioning doesn't interfere with page content
- Performance testing for smooth animations and transitions

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-07-31 | 1.0 | Initial story creation for Epic 7.3 | Scrum Master Bob |

## Dev Agent Record
*This section will be populated during implementation*

## QA Results
*This section will be populated during QA review*